<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NexMeet Â· Login or Continue as Guest</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet" />

  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Embedded CSS -->
  <style>
    /* Global Resets & Base */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
      font-size: 16px;
    }

    body {
      font-family: 'Poppins', sans-serif;
      color: #333333;
      background-color: #FAF2F5;
      min-height: 100vh;
      overflow-y: auto;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    /* Color Variables */
    :root {
      --primary-color: #FF3D6D;
      --primary-hover: #E02B5A;
      --secondary-color: #FF90A8;
      --secondary-hover: #E0758E;
      --light-bg: #FFF0F4;
      --dark-text: #1A1A1A;
      --card-bg: rgba(255, 255, 255, 0.95);
      --gradient-start: #FF6F61;
      --gradient-end: #FF90A8;
    }

    /* Particles.js Background */
    #particles-login {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 0;
    }

    /* Glowing Gradient Overlay */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
      opacity: 0.3;
      filter: blur(60px);
      z-index: 1;
      pointer-events: none; /* Allow clicks to pass through */
    }

    /* Login Container */
    .login-container {
      position: relative;
      width: 90%;
      max-width: 400px;
      background-color: var(--card-bg);
      border-radius: 20px;
      padding: 2rem 1.5rem;
      box-shadow: 0 8px 30px rgba(255, 61, 109, 0.2);
      text-align: center;
      z-index: 3;
      animation: fadeInScale 0.6s ease forwards;
    }

    @keyframes fadeInScale {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }

    /* Pulsating Gradient Border */
    .login-container::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 20px;
      padding: 2px;
      background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
      background-size: 200% 200%;
      animation: gradientShift 6s ease infinite;
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask-composite: exclude;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Titles & Subtitle */
    .login-title {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: var(--dark-text);
    }

    .login-subtitle {
      font-size: 0.9rem;
      font-weight: 300;
      margin-bottom: 1.5rem;
      color: #555555;
      min-height: 36px;
    }

    /* Input & Icon Styles */
    .input-group {
      position: relative;
      margin-bottom: 1rem;
    }

    .input-group .icon {
      position: absolute;
      top: 50%;
      left: 0.75rem;
      transform: translateY(-50%);
      color: var(--secondary-color);
      font-size: 1.1rem;
      transition: color 0.3s ease;
    }

    .input-field {
      width: 100%;
      padding: 0.7rem 0.7rem 0.7rem 2.5rem;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 0.95rem;
      background-color: #FFFFFF;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .input-field:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 8px rgba(255, 61, 109, 0.3);
    }

    .input-field:focus + .icon {
      color: var(--primary-hover);
    }

    /* Divider */
    .divider {
      display: flex;
      align-items: center;
      text-align: center;
      margin: 1.2rem 0;
      color: #888888;
    }

    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid #ddd;
    }

    .divider:not(:empty)::before {
      margin-right: 0.5rem;
    }

    .divider:not(:empty)::after {
      margin-left: 0.5rem;
    }

    /* Buttons */
    .btn {
      border: none;
      border-radius: 50px;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      font-size: 0.95rem;
      font-weight: 500;
      padding: 0.7rem 1.5rem;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
      width: 100%;
      justify-content: center;
      position: relative;
      z-index: 5; /* Ensure buttons are above other elements */
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: #FFFFFF;
      box-shadow: 0 6px 12px rgba(255, 61, 109, 0.2);
    }

    .btn-primary:hover:not(:disabled) {
      background-color: var(--primary-hover);
      transform: translateY(-2px);
      box-shadow: 0 8px 15px rgba(255, 61, 109, 0.3);
    }

    .btn-secondary {
      background-color: var(--secondary-color);
      color: #FFFFFF;
      box-shadow: 0 6px 12px rgba(255, 144, 168, 0.2);
    }

    .btn-secondary:hover:not(:disabled) {
      background-color: var(--secondary-hover);
      transform: translateY(-2px);
      box-shadow: 0 8px 15px rgba(255, 144, 168, 0.3);
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* Loading State */
    .btn.loading::after {
      content: '';
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid #fff;
      border-radius: 50%;
      border-top-color: transparent;
      animation: spin 1s linear infinite;
      margin-left: 8px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Email Form */
    #emailAuthForm {
      display: none;
      opacity: 1;
    }

    #emailAuthForm.visible {
      display: block;
    }

    /* Email Buttons */
    .email-buttons {
      display: flex;
      gap: 0.8rem;
      justify-content: center;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    /* Error Message */
    #error-message {
      color: var(--primary-color);
      font-size: 0.85rem;
      margin-top: 1rem;
      text-align: center;
      display: none;
      z-index: 5; /* Ensure error message is above other elements */
    }

    /* Responsive Design */
    @media (max-width: 480px) {
      .login-container {
        width: 95%;
        padding: 1.5rem 1rem;
      }

      .login-title {
        font-size: 1.6rem;
      }

      .login-subtitle {
        font-size: 0.85rem;
        min-height: 32px;
      }

      .input-field {
        font-size: 0.9rem;
        padding: 0.6rem 0.6rem 0.6rem 2.2rem;
      }

      .btn {
        font-size: 0.9rem;
        padding: 0.6rem 1.2rem;
      }
    }
  </style>
</head>
<body>
  <!-- Particles.js Background -->
  <div id="particles-login" class="particles-container"></div>

  <!-- Login Card Container -->
  <div class="login-container">
    <h1 class="login-title">Welcome to NexMeet</h1>
    <p class="login-subtitle"><span id="typed-login"></span></p>

    <div class="login-options">
      <!-- Anonymous / Guest Button -->
      <button id="anonBtn" class="btn btn-secondary" tabindex="0">
        <i class="fa fa-user-secret"></i> Continue as Guest
      </button>

      <!-- Divider -->
      <div class="divider"><span>or</span></div>

      <!-- Email/Password Form -->
      <form id="emailAuthForm" class="email-form">
        <div class="input-group">
          <i class="fa fa-envelope icon"></i>
          <input
            type="email"
            id="emailInput"
            class="input-field"
            placeholder="Email Address"
            required
            aria-label="Email Address"
          />
        </div>
        <div class="input-group">
          <i class="fa fa-lock icon"></i>
          <input
            type="password"
            id="passwordInput"
            class="input-field"
            placeholder="Password"
            required
            aria-label="Password"
          />
        </div>
        <div class="email-buttons">
          <button id="signUpBtn" type="button" class="btn btn-primary" tabindex="0">
            <i class="fa fa-user-plus"></i> Sign Up
          </button>
          <button id="signInBtn" type="button" class="btn btn-secondary" tabindex="0">
            <i class="fa fa-sign-in-alt"></i> Sign In
          </button>
        </div>
        <div id="error-message"></div>
      </form>

      <!-- Email Form Toggle Button -->
      <button id="emailBtn" class="btn btn-primary" tabindex="0">
        <i class="fa fa-envelope-open"></i> Use Email
      </button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.12/typed.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>
  <script>
    // **Security Warning**: Hardcoding Firebase config is insecure. Move to server-side or use environment variables.
   const firebaseConfig = {
  apiKey: "AIzaSyB1ED_SDykZ3Lda-NsByEKX3pw8bwcmW84",
  authDomain: "nexmeet-89881.firebaseapp.com",
  projectId: "nexmeet-89881",
  storageBucket: "nexmeet-89881.firebasestorage.app",
  messagingSenderId: "750063617210",
  appId: "1:750063617210:web:062e758b0905681780ae83",
  measurementId: "G-9E3T1M3DFZ"
};
    try {
      firebase.initializeApp(firebaseConfig);
    } catch (error) {
      console.error('Firebase initialization failed:', error);
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Fallback if GSAP fails to load
      if (!window.gsap) {
        console.warn('GSAP not loaded, buttons will appear without animation');
        document.querySelectorAll('.btn').forEach(btn => {
          btn.style.opacity = '1';
          btn.style.transform = 'none';
        });
      }

      // Initialize Particles.js with circular particles
      if (window.particlesJS) {
        particlesJS('particles-login', {
          particles: {
            number: { value: 60, density: { enable: true, value_area: 800 } },
            color: { value: '#FF3D6D' },
            shape: { type: 'circle' },
            opacity: { value: 0.5, random: true, anim: { enable: false } },
            size: { value: 8, random: true, anim: { enable: false } },
            move: {
              enable: true,
              speed: 1.5,
              direction: 'top',
              random: true,
              out_mode: 'out'
            }
          },
          interactivity: {
            detect_on: 'canvas',
            events: { onhover: { enable: false }, onclick: { enable: false } },
            modes: {}
          },
          retina_detect: true
        });
      } else {
        console.warn('Particles.js not loaded');
      }

      // Initialize Typed.js for romantic taglines
      if (window.Typed) {
        new Typed('#typed-login', {
          strings: [
            'Find your spark.',
            'Let hearts connect.',
            'Begin a new romance.',
            'Your love journey starts here.'
          ],
          typeSpeed: 50,
          backSpeed: 30,
          backDelay: 1500,
          loop: true
        });
      } else {
        console.warn('Typed.js not loaded');
        document.getElementById('typed-login').textContent = 'Find your spark.';
      }

      // GSAP Animations
      if (window.gsap) {
        gsap.from('.btn', {
          duration: 0.6,
          opacity: 0,
          y: 10,
          ease: 'power3.out',
          stagger: 0.1,
          delay: 0.2
        });
        gsap.from('.input-field', {
          duration: 0.6,
          opacity: 0,
          y: 10,
          ease: 'power3.out',
          stagger: 0.1,
          delay: 0.4
        });
        gsap.from('.icon', {
          duration: 0.6,
          opacity: 0,
          x: -10,
          ease: 'power3.out',
          stagger: 0.1,
          delay: 0.5
        });
      }

      // Toggle Email Form Visibility
      const emailBtn = document.getElementById('emailBtn');
      const emailAuthForm = document.getElementById('emailAuthForm');
      if (emailBtn && emailAuthForm) {
        emailBtn.addEventListener('click', () => {
          const isVisible = emailAuthForm.classList.contains('visible');
          if (!isVisible) {
            emailAuthForm.classList.add('visible');
            emailBtn.innerHTML = '<i class="fa fa-times"></i> Close';
            if (window.gsap) {
              gsap.from('#emailAuthForm .input-field', {
                duration: 0.5,
                opacity: 0,
                y: 10,
                ease: 'power3.out',
                stagger: 0.1
              });
              gsap.from('#emailAuthForm .email-buttons .btn', {
                duration: 0.5,
                opacity: 0,
                y: 10,
                ease: 'power3.out',
                stagger: 0.1,
                delay: 0.2
              });
            }
          } else {
            emailAuthForm.classList.remove('visible');
            emailBtn.innerHTML = '<i class="fa fa-envelope-open"></i> Use Email';
            if (window.gsap) {
              gsap.to('#emailAuthForm', {
                duration: 0.5,
                opacity: 0,
                y: 10,
                ease: 'power3.in',
                onComplete: () => {
                  emailAuthForm.style.opacity = '';
                  emailAuthForm.style.transform = '';
                }
              });
            }
          }
        });
      } else {
        console.error('Email button or form not found in DOM');
      }

      // Show Error Message
      const showError = (message) => {
        const errorContainer = document.getElementById('error-message');
        if (errorContainer) {
          errorContainer.textContent = message;
          errorContainer.style.display = 'block';
          if (window.gsap) {
            gsap.fromTo(
              errorContainer,
              { opacity: 0, y: 5 },
              { opacity: 1, y: 0, duration: 0.4, ease: 'power3.out' }
            );
            setTimeout(() => {
              gsap.to(errorContainer, {
                opacity: 0,
                duration: 0.4,
                ease: 'power3.in',
                onComplete: () => {
                  errorContainer.style.display = 'none';
                }
              });
            }, 3000);
          } else {
            setTimeout(() => {
              errorContainer.style.display = 'none';
            }, 3000);
          }
        }
        console.error('Error:', message);
      };

      // Validate Email
      const validateEmail = (email) => {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      };

      // Firebase Auth Flows
      const anonBtn = document.getElementById('anonBtn');
      const signUpBtn = document.getElementById('signUpBtn');
      const signInBtn = document.getElementById('signInBtn');
      const emailInput = document.getElementById('emailInput');
      const passwordInput = document.getElementById('passwordInput');

      if (!firebase.auth) {
        showError('Firebase Auth not loaded');
        console.error('Firebase Auth not loaded');
        return;
      }

      if (anonBtn) {
        anonBtn.addEventListener('click', () => {
          console.log('Anonymous sign-in clicked');
          anonBtn.disabled = true;
          anonBtn.classList.add('loading');
          firebase.auth().signInAnonymously()
            .then(() => {
              console.log('Anonymous sign-in successful');
              window.location.href = 'preferences.html';
            })
            .catch((error) => {
              showError('Anonymous sign-in failed: ' + error.message);
            })
            .finally(() => {
              anonBtn.disabled = false;
              anonBtn.classList.remove('loading');
            });
        });
      } else {
        console.error('Anonymous button not found');
      }

      if (signUpBtn && emailInput && passwordInput) {
        signUpBtn.addEventListener('click', () => {
          const email = emailInput.value.trim();
          const password = passwordInput.value.trim();
          console.log('Sign-up clicked', { email, password });
          if (!email || !password) {
            showError('Please enter both email and password.');
            return;
          }
          if (!validateEmail(email)) {
            showError('Please enter a valid email address.');
            return;
          }
          if (password.length < 6) {
            showError('Password must be at least 6 characters long.');
            return;
          }
          signUpBtn.disabled = true;
          signUpBtn.classList.add('loading');
          firebase.auth()
            .createUserWithEmailAndPassword(email, password)
            .then(() => {
              console.log('Sign-up successful');
              window.location.href = 'preferences.html';
            })
            .catch((error) => {
              showError('Sign-up failed: ' + error.message);
            })
            .finally(() => {
              signUpBtn.disabled = false;
              signUpBtn.classList.remove('loading');
            });
        });
      } else {
        console.error('Sign-up button or inputs not found');
      }

      if (signInBtn && emailInput && passwordInput) {
        signInBtn.addEventListener('click', () => {
          const email = emailInput.value.trim();
          const password = passwordInput.value.trim();
          console.log('Sign-in clicked', { email, password });
          if (!email || !password) {
            showError('Please enter both email and password.');
            return;
          }
          if (!validateEmail(email)) {
            showError('Please enter a valid email address.');
            return;
          }
          signInBtn.disabled = true;
          signInBtn.classList.add('loading');
          firebase.auth()
            .signInWithEmailAndPassword(email, password)
            .then(() => {
              console.log('Sign-in successful');
              window.location.href = 'preferences.html';
            })
            .catch((error) => {
              showError('Sign-in failed: ' + error.message);
            })
            .finally(() => {
              signInBtn.disabled = false;
              signInBtn.classList.remove('loading');
            });
        });
      } else {
        console.error('Sign-in button or inputs not found');
      }

      // Ensure Card Stays Centered on Resize
      window.addEventListener('resize', () => {
        const loginContainer = document.querySelector('.login-container');
        if (loginContainer) {
          loginContainer.style.margin = '0';
        }
      });
    });
  </script>
</body>
</html>